# 🛍️ E-커머스 서비스 요구사항 분석


---

<!-- TOC -->
* [요약 (Summary)](#요약-summary)
* [요구사항 (Requirements)](#요구사항-requirements)
    * [1. 상품 관리 (Product)](#1-상품-관리-product)
    * [2. 주문 및 결제 (Order)](#2-주문-및-결제-order)
    * [3. 쿠폰 시스템 (Coupon)](#3-쿠폰-시스템-coupon)
    * [4. 사용자 잔액 관리 (Balance)](#4-사용자-잔액-관리-balance)
    * [5. 상품 통계 (ProductRank)](#6-상품-통계-productrank)
<!-- TOC -->

---

## 요약 (Summary)

본 문서는 E-커머스 플랫폼의 핵심 기능(상품 관리, 주문/결제, 쿠폰, 잔액, 통계, 외부 연동)에 대한 요구사항을 정의한다.  
사용자는 상품을 조회하고, 잔액으로 결제하며, 쿠폰을 발급받아 할인 혜택을 받을 수 있다.  
결제 완료 시 주문 정보는 외부 플랫폼으로 전송되며,  
모든 트랜잭션은 일관성과 동시성을 보장해야 한다.

---

## 요구사항 (Requirements)

---

### 🛒 1. 상품 관리 (Product)

**✅ 기능적 요구사항**
+ [ ] 상품 목록을 조회할 수 있어야 한다. (상품명, 가격, 재고 포함)
+ [ ] 특정 상품의 상세 정보를 조회할 수 있다. (상품 ID, 설명, 가격, 재고)
+ [ ] 상품 조회 시 판매 가능한 상품만 표시한다.

**☑️ 비기능적 요구사항**
+ [ ] 상품 재고는 정확해야 하며, 동시성 제어가 필요하다.
+ [ ] 인기 상품 통계는 배치/캐시 처리로 최신화된다.
+ [ ] DB Lock 또는 캐시 일관성 고려 필요.

---

### 💳 2. 주문 및 결제 (Order)

**✅ 기능적 요구사항**
[주문 생성]
+ [ ] 사용자는 유효해야 한다. (사용자 검증)
+ [ ] 주문 생성 시 상품 존재 여부를 검증한다.
+ [ ] 재고가 충분하지 않으면 주문 실패 및 오류 반환.
+ [ ] 주문 생성 성공 시 재고가 자동으로 차감된다.
+ [ ] 주문 ID, 상품 목록, 총액, 상태("대기")를 반환한다.
+ [ ] 동시 주문 시에도 재고 정합성이 유지되어야 한다.

[결제 처리]
+ [ ] 잔액이 주문 금액보다 많거나 같으면 결제가 성공한다.
+ [ ] 결제 성공 시 잔액 차감 및 주문 상태 "결제 완료"로 변경한다.
+ [ ] 잔액 부족 시 결제 실패 및 메시지 반환.
+ [ ] 결제 시 쿠폰 ID 존재 시, 쿠폰을 검증 후 할인 적용.
+ [ ] 쿠폰 사용 시 쿠폰 상태 "사용 완료"로 변경된다.
+ [ ] 결제 실패 시 차감된 재고를 복구한다. (트랜잭션 롤백)

[외부 전송]
+ [ ] 결제 완료 후 주문 데이터를 외부 플랫폼으로 전송한다.

**☑️ 비기능적 요구사항**
+ [ ] 주문/결제는 트랜잭션 단위로 처리되어야 한다. (All or Nothing)
+ [ ] 재고, 잔액, 쿠폰 사용 시 동시성 보장이 필요하다.
+ [ ] 외부 전송은 비동기로 처리하며, 실패 시 재시도해야 한다.

---

### 🎟️ 3. 쿠폰 시스템 (Coupon)

**✅ 기능적 요구사항**

[보유 쿠폰 조회]
+ [ ] 사용자는 유효해야 한다. (사용자 검증)
+ [ ] 쿠폰 목록(ID, 이름, 할인율, 만료일)을 조회한다.
+ [ ] 사용 가능한 쿠폰만 표시한다.

[선착순 쿠폰 발급]
+ [ ] 사용자는 유효해야 한다. (사용자 검증)
+ [ ] 쿠폰이 존재해야 한다. (쿠폰 검증)
+ [ ] 중복 발급 여부를 검증한다.
+ [ ] 쿠폰 발급 가능 수량이 남아있어야 한다.
+ [ ] 만료일 이전이어야 한다.

[쿠폰 사용]
+ [ ] 결제 시 쿠폰 유효성을 검증한다. (유효기간, 소유자, 사용여부)
+ [ ] 유효 쿠폰 사용 시 할인 적용.
+ [ ] 사용 완료된 쿠폰은 재사용 불가.
+ [ ] 쿠폰 사용/발급 일시 기록.

**☑️ 비기능적 요구사항**
+ [ ] 쿠폰 발급 시 동시성 제어 보장 (공정모드 또는 분산락)
+ [ ] 쿠폰 초과 발급이 발생하지 않아야 한다.
+ [ ] 쿠폰 검증, 사용, 갱신은 트랜잭션 단위로 처리되어야 한다.

---

### 💰 4. 사용자 잔액 관리 (Balance)

**✅ 기능적 요구사항**

[잔액 조회]
+ [ ] 사용자는 유효해야 한다.
+ [ ] 잔액이 없으면 0을 반환한다.
+ [ ] 잔액 정보를 반환한다.

[잔액 충전]
+ [ ] 사용자는 유효해야 한다.
+ [ ] 충전 금액은 0보다 커야 한다.
+ [ ] 잔고가 존재하지 않으면 새로 생성 후 충전한다.
+ [ ] 기존 잔고가 있으면 금액을 더해 업데이트한다.
+ [ ] 최대 잔액을 초과할 수 없다.
+ [ ] 충전 후 이력 테이블에 기록된다. (거래 타입, 금액, 일시)

**☑️ 비기능적 요구사항**
+ [ ] 동시에 여러 사용자가 충전 시에도 한도 초과가 발생하지 않아야 한다. (동시성 제어)
+ [ ] 충전 요청은 트랜잭션으로 관리되어야 한다.

---

### 🔄 5. 데이터 연동 (Data Integration)

**✅ 기능적 요구사항**
+ [ ] 결제 완료 시 주문 데이터를 외부 시스템으로 전송한다.
+ [ ] 전송 데이터에는 주문 ID, 고객 정보, 상품, 금액이 포함된다.
+ [ ] 전송 실패 시에도 주문 자체는 정상 처리된다.

**☑️ 비기능적 요구사항**
+ [ ] 외부 전송은 비동기로 처리되어야 한다.
+ [ ] 전송 실패 시 로그 및 상태 관리가 필요하다.

---

### 📊 6. 상품 통계 (ProductRank)

**✅ 기능적 요구사항**
+ [ ] 최근 3일간 결제 완료된 주문 기준으로 Top 5 상품을 집계한다.
+ [ ] 판매량 기준으로 정렬된다.
+ [ ] 집계 결과는 캐싱 또는 별도 통계 테이블에 저장한다.

**☑️ 비기능적 요구사항**
+ [ ] 캐싱 전략을 통해 성능을 최적화한다.

---
